<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Google Data Analytics Capstone Project | Daniel Herrera </title> <meta name="author" content="Daniel Herrera"> <meta name="description" content="with background image"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%93%88&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://danielvertex.github.io/projects/Practical_case_1/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Daniel</span> Herrera </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/books/">bookshelf</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Google Data Analytics Capstone Project</h1> <p class="post-description">with background image</p> </header> <article> <p>You can find a slide presentation can be found <a href="https://drive.google.com/file/d/1uNC35c59zYAWCu7_nfDrw1dSJPzbGKoJ/view?usp=sharing" rel="external nofollow noopener" target="_blank">here</a>.</p> <h1 id="introducction">INTRODUCCTION</h1> <p>You are a junior data analyst working in the marketing analyst team at Cyclistic, a bike-share company in Chicago. The director of marketing believes the company’s future success depends on maximizing the number of annual memberships. Therefore, your team wants to understand how casual riders and annual members use Cyclistic bikes differently. From these insights, your team will design a new marketing strategy to convert casual riders into annual members. But first, Cyclistic executives must approve your recommendations, so they must be backed up with compelling data insights and professional data visualizations.</p> <h1 id="scenario">SCENARIO</h1> <p>You are a junior data analyst working in the marketing analyst team at Cyclistic, a bike-share company in Chicago. The director of marketing believes the company’s future success depends on maximizing the number of annual memberships. Therefore, your team wants to understand how casual riders and annual members use Cyclistic bikes differently. From these insights, your team will design a new marketing strategy to convert casual riders into annual members.</p> <h2 id="characters-and-teams">Characters and Teams</h2> <p><strong>Cyclistic:</strong> A bike-sharing program that includes 5,800 bicycles and 600 stations. Cyclistic stands out for also offering recumbent bikes, hand tricycles, and cargo bikes that provide a more inclusive bike-sharing experience for people with disabilities and cyclists who cannot use a standard two-wheeled bicycle. Most cyclists choose traditional bikes, while around 8% of cyclists use the assisted options. Cyclistic users are more likely to ride for recreation, but about 30% use the bikes for commuting to work each day.</p> <p><strong>Lily Moreno:</strong> The Director of Marketing and your manager. Moreno is responsible for developing campaigns and initiatives to promote the bike-sharing program. Campaigns may include email, social media, and other channels.</p> <p><strong>Cyclistic’s Marketing Data Analytics Team:</strong> A team of data analysts responsible for collecting, analyzing, and reporting data that helps drive Cyclistic’s marketing strategy. You joined this team six months ago, and you have been dedicated not only to understanding Cyclistic’s mission and business goals but also to finding ways to help Cyclistic achieve them from your position as a junior data analyst.</p> <p><strong>Cyclistic Executive Team:</strong> The highly detail-oriented executive team will decide whether to approve the recommended marketing program.</p> <h2 id="about-the-company">About the Company</h2> <p>In 2016, Cyclistic launched a successful bike-sharing service. Since then, the program has grown to include a fleet of 5,824 geo-referenced bicycles, locked within a network of 692 stations throughout Chicago. The bikes can be unlocked from one station and returned to any other station in the system at any time.</p> <p>Until now, Cyclistic’s marketing strategy has focused on building general brand recognition and attracting broad consumer segments. One of the key approaches that made this possible was the flexibility of their pricing plans: single-ride passes, full-day passes, and annual memberships. Customers who purchase single-ride or full-day passes are called casual riders. Customers who purchase annual memberships are called Cyclistic members.</p> <p>Cyclistic’s financial analysts concluded that annual members are far more profitable than casual riders. While the flexible pricing helps Cyclistic attract more customers, Moreno believes that maximizing the number of annual members will be key to future growth. Rather than creating a marketing campaign aimed at all new customers, Moreno believes there is significant potential to convert casual riders into members. She points out that casual riders are already familiar with Cyclistic’s program and have chosen Cyclistic for their mobility needs.</p> <p>Moreno set a clear goal: to design marketing strategies aimed at converting casual riders into annual members. However, to do so, the marketing analytics team needs a better understanding of how annual members and casual riders differ, why casual riders would purchase a membership, and how digital media might influence their marketing tactics. Moreno and her team are interested in analyzing Cyclistic’s historical bike trip data to identify trends.</p> <h2 id="questions">Questions</h2> <p>Three questions will guide the future marketing program: + How do annual members and casual riders differ in their use of Cyclistic’s bikes? + Why would casual riders purchase annual memberships from Cyclistic? + How can Cyclistic use digital media to influence casual riders to become members?</p> <p>Moreno assigned you the first question to answer: <strong>How do annual members and casual riders differ in their use of Cyclistic’s bikes?</strong></p> <p>You will create a report with the following deliverables:</p> <ul> <li>A clear instruction of the business task</li> <li>A description of all data sources used</li> <li>Documentation of all data cleaning and manipulations</li> <li>A summary of your analysis</li> <li>Supporting visualizations and key findings</li> <li>The three most important recommendations based on your analysis</li> </ul> <p>This project will follow the steps of the data analysis process: ask, prepare, process, analyze, share, and act.</p> <h1 id="prepare">PREPARE</h1> <p>Historical ride data from Cyclistic will be used to analyze and identify trends. The latest 12 months of Cyclistic ride data can be downloaded here. (Note: The datasets have different datasets are appropriate and will enable the answering of the company’s questions. The data has been provided by Motivate International Inc. under this license.) These are public data that can be utilized to explore how different types of customers use Cyclistic bikes. However, it should be noted that, for privacy reasons, the use of personally identifiable information of cyclists is prohibited. This means that connections between pass purchases and credit card numbers cannot be established to determine if casual riders reside within the Cyclistic service area or if they have purchased multiple single-ride passes. The data for the entire year of 2023 was selected to avoid biases associated with partial periods and to ensure that factors such as holidays, seasons, and other seasonal patterns that may influence bicycle usage are taken into account, also meets the ROCCC criteria (Relevant, Original, Complete, Consistent, and Correct), ensuring the quality and reliability of the data for conducting an accurate analysis.</p> <h1 id="process">PROCESS</h1> <p>R with will be used for data analysis, statistics, and visualization due to their significant advantages. R is specifically designed for statistical tasks, featuring an extensive ecosystem of packages that enhance its capabilities, such as ggplot2 for visualization and dplyr for data manipulation. The active R community provides abundant resources and support. RStudio serves as an integrated development environment (IDE) that facilitates project organization, includes tools for syntax highlighting and debugging, and supports version control systems like Git. Additionally, RStudio’s integration with R Markdown allows for the creation of reproducible documents that combine text, code, and results, making it ideal for reporting. Together, R and RStudio create a powerful combination preferred by analysts and data scientists.</p> <p>The data for the year comes in 12 separate CSV files, one for each month. Once downloaded, the compare_df_cols_same() function from the janitor package was used to verify that all 12 datasets were suitable for merging.</p> <p>We start with loading the packages we will use.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="n">lubridate</span><span class="p">)</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="n">janitor</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Warning: package 'janitor' was built under R version 4.4.3</span><span class="w">

    </span><span class="n">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Warning: package 'scales' was built under R version 4.4.3</span><span class="w">

    </span><span class="n">library</span><span class="p">(</span><span class="n">viridis</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Warning: package 'viridis' was built under R version 4.4.3</span><span class="w">

    </span><span class="n">library</span><span class="p">(</span><span class="n">hrbrthemes</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Warning: package 'hrbrthemes' was built under R version 4.4.3</span><span class="w">

    </span><span class="n">library</span><span class="p">(</span><span class="n">almanac</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Warning: package 'almanac' was built under R version 4.4.3</span><span class="w">

    </span><span class="n">library</span><span class="p">(</span><span class="n">Cairo</span><span class="p">)</span><span class="w">

    </span><span class="n">getwd</span><span class="p">()</span><span class="w">

    </span><span class="c1">## [1] "D:/Proyecto_R"</span><span class="w">

    </span><span class="n">setwd</span><span class="p">(</span><span class="s2">"D:/Proyecto_R"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h2 id="collect-data">Collect data</h2> <p>Load the datasets an rename</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">M01_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202301-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M02_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202302-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M03_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202303-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M04_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202304-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M05_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202305-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M06_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202306-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M07_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202307-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M08_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202308-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M09_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202309-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M10_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202310-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M11_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202311-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
    </span><span class="n">M12_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"202312-divvy-tripdata.csv"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h2 id="wrangle-data-and-combine-into-a-single-file">WRANGLE DATA AND COMBINE INTO A SINGLE FILE</h2> <p>Before combining the datasets, it was checked whether the data frames were row-bindable. The function <code class="language-plaintext highlighter-rouge">compare_df_cols()</code> was used, which returns TRUE if there are no mismatching rows.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">compare_df_cols_same</span><span class="p">(</span><span class="n">M01_2023</span><span class="p">,</span><span class="n">M02_2023</span><span class="p">,</span><span class="n">M03_2023</span><span class="p">,</span><span class="n">M04_2023</span><span class="p">,</span><span class="n">M05_2023</span><span class="p">,</span><span class="n">M06_2023</span><span class="p">,</span><span class="n">M07_2023</span><span class="p">,</span><span class="n">M08_2023</span><span class="p">,</span><span class="n">M09_2023</span><span class="p">,</span><span class="n">M10_2023</span><span class="p">,</span><span class="n">M11_2023</span><span class="p">,</span><span class="n">M12_2023</span><span class="p">)</span><span class="w">

    </span><span class="c1">## [1] TRUE</span><span class="w">
</span></code></pre></div></div> <p>All the data was combined into a single data frame, and incongruities were searched for.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">bind_rows</span><span class="p">(</span><span class="n">M01_2023</span><span class="p">,</span><span class="n">M02_2023</span><span class="p">,</span><span class="n">M03_2023</span><span class="p">,</span><span class="n">M04_2023</span><span class="p">,</span><span class="n">M05_2023</span><span class="p">,</span><span class="n">M06_2023</span><span class="p">,</span><span class="n">M07_2023</span><span class="p">,</span><span class="n">M08_2023</span><span class="p">,</span><span class="n">M09_2023</span><span class="p">,</span><span class="n">M10_2023</span><span class="p">,</span><span class="n">M11_2023</span><span class="p">,</span><span class="n">M12_2023</span><span class="p">)</span><span class="w">
    </span><span class="n">str</span><span class="p">(</span><span class="n">annual_data</span><span class="p">)</span><span class="w">

    </span><span class="c1">## spc_tbl_ [5,719,877 × 13] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span><span class="w">
    </span><span class="c1">##  $ ride_id           : chr [1:5719877] "F96D5A74A3E41399" "13CB7EB698CEDB88" "BD88A2E670661CE5" "C90792D034FED968" ...</span><span class="w">
    </span><span class="c1">##  $ rideable_type     : chr [1:5719877] "electric_bike" "classic_bike" "electric_bike" "classic_bike" ...</span><span class="w">
    </span><span class="c1">##  $ started_at        : POSIXct[1:5719877], format: "2023-01-21 20:05:42" "2023-01-10 15:37:36" ...</span><span class="w">
    </span><span class="c1">##  $ ended_at          : POSIXct[1:5719877], format: "2023-01-21 20:16:33" "2023-01-10 15:46:05" ...</span><span class="w">
    </span><span class="c1">##  $ start_station_name: chr [1:5719877] "Lincoln Ave &amp; Fullerton Ave" "Kimbark Ave &amp; 53rd St" "Western Ave &amp; Lunt Ave" "Kimbark Ave &amp; 53rd St" ...</span><span class="w">
    </span><span class="c1">##  $ start_station_id  : chr [1:5719877] "TA1309000058" "TA1309000037" "RP-005" "TA1309000037" ...</span><span class="w">
    </span><span class="c1">##  $ end_station_name  : chr [1:5719877] "Hampden Ct &amp; Diversey Ave" "Greenwood Ave &amp; 47th St" "Valli Produce - Evanston Plaza" "Greenwood Ave &amp; 47th St" ...</span><span class="w">
    </span><span class="c1">##  $ end_station_id    : chr [1:5719877] "202480.0" "TA1308000002" "599" "TA1308000002" ...</span><span class="w">
    </span><span class="c1">##  $ start_lat         : num [1:5719877] 41.9 41.8 42 41.8 41.8 ...</span><span class="w">
    </span><span class="c1">##  $ start_lng         : num [1:5719877] -87.6 -87.6 -87.7 -87.6 -87.6 ...</span><span class="w">
    </span><span class="c1">##  $ end_lat           : num [1:5719877] 41.9 41.8 42 41.8 41.8 ...</span><span class="w">
    </span><span class="c1">##  $ end_lng           : num [1:5719877] -87.6 -87.6 -87.7 -87.6 -87.6 ...</span><span class="w">
    </span><span class="c1">##  $ member_casual     : chr [1:5719877] "member" "member" "casual" "member" ...</span><span class="w">
    </span><span class="c1">##  - attr(*, "spec")=</span><span class="w">
    </span><span class="c1">##   .. cols(</span><span class="w">
    </span><span class="c1">##   ..   ride_id = col_character(),</span><span class="w">
    </span><span class="c1">##   ..   rideable_type = col_character(),</span><span class="w">
    </span><span class="c1">##   ..   started_at = col_datetime(format = ""),</span><span class="w">
    </span><span class="c1">##   ..   ended_at = col_datetime(format = ""),</span><span class="w">
    </span><span class="c1">##   ..   start_station_name = col_character(),</span><span class="w">
    </span><span class="c1">##   ..   start_station_id = col_character(),</span><span class="w">
    </span><span class="c1">##   ..   end_station_name = col_character(),</span><span class="w">
    </span><span class="c1">##   ..   end_station_id = col_character(),</span><span class="w">
    </span><span class="c1">##   ..   start_lat = col_double(),</span><span class="w">
    </span><span class="c1">##   ..   start_lng = col_double(),</span><span class="w">
    </span><span class="c1">##   ..   end_lat = col_double(),</span><span class="w">
    </span><span class="c1">##   ..   end_lng = col_double(),</span><span class="w">
    </span><span class="c1">##   ..   member_casual = col_character()</span><span class="w">
    </span><span class="c1">##   .. )</span><span class="w">
    </span><span class="c1">##  - attr(*, "problems")=&lt;externalptr&gt;</span><span class="w">
</span></code></pre></div></div> <p>Columns were renamed to make them understandable.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rename</span><span class="p">(</span><span class="n">annual_data</span><span class="p">,</span><span class="w"> </span><span class="n">user_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">member_casual</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <h2 id="clean">CLEAN</h2> <p>The duration of each ride in minutes will be calculated and stored in the <code class="language-plaintext highlighter-rouge">ride_length</code> column. The <code class="language-plaintext highlighter-rouge">difftime</code> function computes the difference between the <code class="language-plaintext highlighter-rouge">ended_at and</code> <code class="language-plaintext highlighter-rouge">started_at</code> timestamps. Initially, the result is of class <code class="language-plaintext highlighter-rouge">difftime</code>, which is not suitable for direct numerical operations.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data</span><span class="o">$</span><span class="n">ride_length</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">difftime</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">ended_at</span><span class="p">,</span><span class="w"> </span><span class="n">annual_data</span><span class="o">$</span><span class="n">started_at</span><span class="p">,</span><span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"mins"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>It was verified that the user_type column only had two possible values, and it was checked for duplicates and empty IDs.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">unique</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">user_type</span><span class="p">)</span><span class="w">

    </span><span class="c1">## [1] "member" "casual"</span><span class="w">

    </span><span class="nf">sum</span><span class="p">(</span><span class="n">duplicated</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">ride_id</span><span class="p">))</span><span class="w">

    </span><span class="c1">## [1] 0</span><span class="w">

    </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">ride_id</span><span class="p">))</span><span class="w">

    </span><span class="c1">## [1] 0</span><span class="w">

    </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">ride_length</span><span class="p">))</span><span class="w">

    </span><span class="c1">## [1] 0</span><span class="w">
</span></code></pre></div></div> <p>Columns will be added to list the date, month, day, and year of each ride. This will facilitate the aggregation of ride data by month, day, or year.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data</span><span class="o">$</span><span class="n">date</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">started_at</span><span class="p">)</span><span class="w"> </span><span class="c1">#The default format is yyyy-mm-dd</span><span class="w">
    </span><span class="n">annual_data</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">format</span><span class="p">(</span><span class="n">as.Date</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">date</span><span class="p">),</span><span class="w"> </span><span class="s2">"%m"</span><span class="p">)</span><span class="w">
    </span><span class="n">annual_data</span><span class="o">$</span><span class="n">day</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">format</span><span class="p">(</span><span class="n">as.Date</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">date</span><span class="p">),</span><span class="w"> </span><span class="s2">"%d"</span><span class="p">)</span><span class="w">
    </span><span class="n">annual_data</span><span class="o">$</span><span class="n">year</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">format</span><span class="p">(</span><span class="n">as.Date</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">date</span><span class="p">),</span><span class="w"> </span><span class="s2">"%Y"</span><span class="p">)</span><span class="w">
    </span><span class="n">annual_data</span><span class="o">$</span><span class="n">day_of_week</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">format</span><span class="p">(</span><span class="n">as.Date</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">date</span><span class="p">),</span><span class="w"> </span><span class="s2">"%A"</span><span class="p">)</span><span class="w">
    </span><span class="n">glimpse</span><span class="p">(</span><span class="n">annual_data</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Rows: 5,719,877</span><span class="w">
    </span><span class="c1">## Columns: 19</span><span class="w">
    </span><span class="c1">## $ ride_id            &lt;chr&gt; "F96D5A74A3E41399", "13CB7EB698CEDB88", "BD88A2E670…</span><span class="w">
    </span><span class="c1">## $ rideable_type      &lt;chr&gt; "electric_bike", "classic_bike", "electric_bike", "…</span><span class="w">
    </span><span class="c1">## $ started_at         &lt;dttm&gt; 2023-01-21 20:05:42, 2023-01-10 15:37:36, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ ended_at           &lt;dttm&gt; 2023-01-21 20:16:33, 2023-01-10 15:46:05, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ start_station_name &lt;chr&gt; "Lincoln Ave &amp; Fullerton Ave", "Kimbark Ave &amp; 53rd …</span><span class="w">
    </span><span class="c1">## $ start_station_id   &lt;chr&gt; "TA1309000058", "TA1309000037", "RP-005", "TA130900…</span><span class="w">
    </span><span class="c1">## $ end_station_name   &lt;chr&gt; "Hampden Ct &amp; Diversey Ave", "Greenwood Ave &amp; 47th …</span><span class="w">
    </span><span class="c1">## $ end_station_id     &lt;chr&gt; "202480.0", "TA1308000002", "599", "TA1308000002", …</span><span class="w">
    </span><span class="c1">## $ start_lat          &lt;dbl&gt; 41.92407, 41.79957, 42.00857, 41.79957, 41.79957, 4…</span><span class="w">
    </span><span class="c1">## $ start_lng          &lt;dbl&gt; -87.64628, -87.59475, -87.69048, -87.59475, -87.594…</span><span class="w">
    </span><span class="c1">## $ end_lat            &lt;dbl&gt; 41.93000, 41.80983, 42.03974, 41.80983, 41.80983, 4…</span><span class="w">
    </span><span class="c1">## $ end_lng            &lt;dbl&gt; -87.64000, -87.59938, -87.69941, -87.59938, -87.599…</span><span class="w">
    </span><span class="c1">## $ user_type          &lt;chr&gt; "member", "member", "casual", "member", "member", "…</span><span class="w">
    </span><span class="c1">## $ ride_length        &lt;drtn&gt; 10.850000 mins, 8.483333 mins, 13.233333 mins, 8.7…</span><span class="w">
    </span><span class="c1">## $ date               &lt;date&gt; 2023-01-21, 2023-01-10, 2023-01-02, 2023-01-22, 20…</span><span class="w">
    </span><span class="c1">## $ month              &lt;chr&gt; "01", "01", "01", "01", "01", "01", "01", "01", "01…</span><span class="w">
    </span><span class="c1">## $ day                &lt;chr&gt; "21", "10", "02", "22", "12", "31", "15", "25", "25…</span><span class="w">
    </span><span class="c1">## $ year               &lt;chr&gt; "2023", "2023", "2023", "2023", "2023", "2023", "20…</span><span class="w">
    </span><span class="c1">## $ day_of_week        &lt;chr&gt; "sábado", "martes", "lunes", "domingo", "jueves", "…</span><span class="w">
</span></code></pre></div></div> <p>The language will be changed to English, and a column will be added for ride length.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="n">annual_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">mutate</span><span class="p">(</span><span class="n">day_of_week</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recode</span><span class="p">(</span><span class="n">day_of_week</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"lunes"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Monday"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"martes"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Tuesday"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"miércoles"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Wednesday"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"jueves"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Thursday"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"viernes"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Friday"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"sábado"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Saturday"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"domingo"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sunday"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <p>Use <code class="language-plaintext highlighter-rouge">glimpse</code> to inspect the data and verify the type of the <code class="language-plaintext highlighter-rouge">ride_length</code> column. It is important to note that the <code class="language-plaintext highlighter-rouge">ride_length</code> column is initially of class <code class="language-plaintext highlighter-rouge">difftime</code>.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">glimpse</span><span class="p">(</span><span class="n">annual_data</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Rows: 5,719,877</span><span class="w">
    </span><span class="c1">## Columns: 19</span><span class="w">
    </span><span class="c1">## $ ride_id            &lt;chr&gt; "F96D5A74A3E41399", "13CB7EB698CEDB88", "BD88A2E670…</span><span class="w">
    </span><span class="c1">## $ rideable_type      &lt;chr&gt; "electric_bike", "classic_bike", "electric_bike", "…</span><span class="w">
    </span><span class="c1">## $ started_at         &lt;dttm&gt; 2023-01-21 20:05:42, 2023-01-10 15:37:36, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ ended_at           &lt;dttm&gt; 2023-01-21 20:16:33, 2023-01-10 15:46:05, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ start_station_name &lt;chr&gt; "Lincoln Ave &amp; Fullerton Ave", "Kimbark Ave &amp; 53rd …</span><span class="w">
    </span><span class="c1">## $ start_station_id   &lt;chr&gt; "TA1309000058", "TA1309000037", "RP-005", "TA130900…</span><span class="w">
    </span><span class="c1">## $ end_station_name   &lt;chr&gt; "Hampden Ct &amp; Diversey Ave", "Greenwood Ave &amp; 47th …</span><span class="w">
    </span><span class="c1">## $ end_station_id     &lt;chr&gt; "202480.0", "TA1308000002", "599", "TA1308000002", …</span><span class="w">
    </span><span class="c1">## $ start_lat          &lt;dbl&gt; 41.92407, 41.79957, 42.00857, 41.79957, 41.79957, 4…</span><span class="w">
    </span><span class="c1">## $ start_lng          &lt;dbl&gt; -87.64628, -87.59475, -87.69048, -87.59475, -87.594…</span><span class="w">
    </span><span class="c1">## $ end_lat            &lt;dbl&gt; 41.93000, 41.80983, 42.03974, 41.80983, 41.80983, 4…</span><span class="w">
    </span><span class="c1">## $ end_lng            &lt;dbl&gt; -87.64000, -87.59938, -87.69941, -87.59938, -87.599…</span><span class="w">
    </span><span class="c1">## $ user_type          &lt;chr&gt; "member", "member", "casual", "member", "member", "…</span><span class="w">
    </span><span class="c1">## $ ride_length        &lt;drtn&gt; 10.850000 mins, 8.483333 mins, 13.233333 mins, 8.7…</span><span class="w">
    </span><span class="c1">## $ date               &lt;date&gt; 2023-01-21, 2023-01-10, 2023-01-02, 2023-01-22, 20…</span><span class="w">
    </span><span class="c1">## $ month              &lt;chr&gt; "01", "01", "01", "01", "01", "01", "01", "01", "01…</span><span class="w">
    </span><span class="c1">## $ day                &lt;chr&gt; "21", "10", "02", "22", "12", "31", "15", "25", "25…</span><span class="w">
    </span><span class="c1">## $ year               &lt;chr&gt; "2023", "2023", "2023", "2023", "2023", "2023", "20…</span><span class="w">
    </span><span class="c1">## $ day_of_week        &lt;chr&gt; "Saturday", "Tuesday", "Monday", "Sunday", "Thursda…</span><span class="w">
</span></code></pre></div></div> <p>Convert the <code class="language-plaintext highlighter-rouge">ride_length</code> column from <code class="language-plaintext highlighter-rouge">difftime</code> to a numeric type to enable further numerical operations. This conversion is necessary because <code class="language-plaintext highlighter-rouge">difftime</code> objects cannot be directly utilized in mathematical calculations.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data</span><span class="o">$</span><span class="n">ride_length</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">annual_data</span><span class="o">$</span><span class="n">ride_length</span><span class="p">)</span><span class="w">

    </span><span class="c1">#remove rows from the data frame that have NA values in at least one column</span><span class="w">
    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">annual_data</span><span class="p">[</span><span class="n">complete.cases</span><span class="p">(</span><span class="n">annual_data</span><span class="p">),]</span><span class="w">
    </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="p">))</span><span class="w">

    </span><span class="c1">## [1] 0</span><span class="w">

    </span><span class="n">glimpse</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Rows: 4,331,707</span><span class="w">
    </span><span class="c1">## Columns: 19</span><span class="w">
    </span><span class="c1">## $ ride_id            &lt;chr&gt; "F96D5A74A3E41399", "13CB7EB698CEDB88", "BD88A2E670…</span><span class="w">
    </span><span class="c1">## $ rideable_type      &lt;chr&gt; "electric_bike", "classic_bike", "electric_bike", "…</span><span class="w">
    </span><span class="c1">## $ started_at         &lt;dttm&gt; 2023-01-21 20:05:42, 2023-01-10 15:37:36, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ ended_at           &lt;dttm&gt; 2023-01-21 20:16:33, 2023-01-10 15:46:05, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ start_station_name &lt;chr&gt; "Lincoln Ave &amp; Fullerton Ave", "Kimbark Ave &amp; 53rd …</span><span class="w">
    </span><span class="c1">## $ start_station_id   &lt;chr&gt; "TA1309000058", "TA1309000037", "RP-005", "TA130900…</span><span class="w">
    </span><span class="c1">## $ end_station_name   &lt;chr&gt; "Hampden Ct &amp; Diversey Ave", "Greenwood Ave &amp; 47th …</span><span class="w">
    </span><span class="c1">## $ end_station_id     &lt;chr&gt; "202480.0", "TA1308000002", "599", "TA1308000002", …</span><span class="w">
    </span><span class="c1">## $ start_lat          &lt;dbl&gt; 41.92407, 41.79957, 42.00857, 41.79957, 41.79957, 4…</span><span class="w">
    </span><span class="c1">## $ start_lng          &lt;dbl&gt; -87.64628, -87.59475, -87.69048, -87.59475, -87.594…</span><span class="w">
    </span><span class="c1">## $ end_lat            &lt;dbl&gt; 41.93000, 41.80983, 42.03974, 41.80983, 41.80983, 4…</span><span class="w">
    </span><span class="c1">## $ end_lng            &lt;dbl&gt; -87.64000, -87.59938, -87.69941, -87.59938, -87.599…</span><span class="w">
    </span><span class="c1">## $ user_type          &lt;chr&gt; "member", "member", "casual", "member", "member", "…</span><span class="w">
    </span><span class="c1">## $ ride_length        &lt;dbl&gt; 10.850000, 8.483333, 13.233333, 8.766667, 15.316667…</span><span class="w">
    </span><span class="c1">## $ date               &lt;date&gt; 2023-01-21, 2023-01-10, 2023-01-02, 2023-01-22, 20…</span><span class="w">
    </span><span class="c1">## $ month              &lt;chr&gt; "01", "01", "01", "01", "01", "01", "01", "01", "01…</span><span class="w">
    </span><span class="c1">## $ day                &lt;chr&gt; "21", "10", "02", "22", "12", "31", "15", "25", "25…</span><span class="w">
    </span><span class="c1">## $ year               &lt;chr&gt; "2023", "2023", "2023", "2023", "2023", "2023", "20…</span><span class="w">
    </span><span class="c1">## $ day_of_week        &lt;chr&gt; "Saturday", "Tuesday", "Monday", "Sunday", "Thursda…</span><span class="w">
</span></code></pre></div></div> <p>Verify that all ride lengths are positive and that there are no empty values.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="c1">#search for negative values, less than 1 or grater than one day (1440 minutes)</span><span class="w">
    </span><span class="nf">sum</span><span class="p">((</span><span class="n">annual_data</span><span class="o">$</span><span class="n">ride_length</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">))</span><span class="w">

    </span><span class="c1">## [1] 1269</span><span class="w">

    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">ride_length</span><span class="o">&lt;=</span><span class="m">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ride_length</span><span class="w">  </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1440</span><span class="p">)</span><span class="w">

    </span><span class="c1">## # A tibble: 702 × 19</span><span class="w">
    </span><span class="c1">##    ride_id          rideable_type started_at          ended_at</span><span class="w">
    </span><span class="c1">##    &lt;chr&gt;            &lt;chr&gt;         &lt;dttm&gt;              &lt;dttm&gt;</span><span class="w">
    </span><span class="c1">##  1 F4F4A74BF1FB016D classic_bike  2023-01-06 15:59:56 2023-01-07 16:41:17</span><span class="w">
    </span><span class="c1">##  2 3F5B7E5AD8A6FE18 electric_bike 2023-01-17 08:31:49 2023-01-17 08:31:49</span><span class="w">
    </span><span class="c1">##  3 5394CACAFE68B950 electric_bike 2023-01-05 09:10:39 2023-01-05 09:10:39</span><span class="w">
    </span><span class="c1">##  4 4AE8A56D4F625567 electric_bike 2023-01-05 16:53:43 2023-01-05 16:53:43</span><span class="w">
    </span><span class="c1">##  5 C42B78BC641B2610 docked_bike   2023-01-10 14:49:17 2023-01-11 14:52:22</span><span class="w">
    </span><span class="c1">##  6 171805AF2A8BD1AF classic_bike  2023-01-18 20:48:35 2023-01-19 21:14:52</span><span class="w">
    </span><span class="c1">##  7 AB6BF61F4BB57AAB electric_bike 2023-01-08 14:27:26 2023-01-08 14:27:26</span><span class="w">
    </span><span class="c1">##  8 89AB3E68A1FE1D42 classic_bike  2023-01-13 18:00:46 2023-01-14 18:58:38</span><span class="w">
    </span><span class="c1">##  9 D591DA5ED36A2F38 classic_bike  2023-01-11 13:36:04 2023-01-12 14:09:39</span><span class="w">
    </span><span class="c1">## 10 6B3734E0279EB5A6 electric_bike 2023-02-19 17:52:09 2023-02-19 17:52:09</span><span class="w">
    </span><span class="c1">## # ℹ 692 more rows</span><span class="w">
    </span><span class="c1">## # ℹ 15 more variables: start_station_name &lt;chr&gt;, start_station_id &lt;chr&gt;,</span><span class="w">
    </span><span class="c1">## #   end_station_name &lt;chr&gt;, end_station_id &lt;chr&gt;, start_lat &lt;dbl&gt;,</span><span class="w">
    </span><span class="c1">## #   start_lng &lt;dbl&gt;, end_lat &lt;dbl&gt;, end_lng &lt;dbl&gt;, user_type &lt;chr&gt;,</span><span class="w">
    </span><span class="c1">## #   ride_length &lt;dbl&gt;, date &lt;date&gt;, month &lt;chr&gt;, day &lt;chr&gt;, year &lt;chr&gt;,</span><span class="w">
    </span><span class="c1">## #   day_of_week &lt;chr&gt;</span><span class="w">

    </span><span class="c1">#applying the result</span><span class="w">
    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">ride_length</span><span class="o">&lt;=</span><span class="m">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ride_length</span><span class="w">  </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1440</span><span class="p">))</span><span class="w">

    </span><span class="c1">#search for NA values in ride_length column</span><span class="w">
    </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">ride_length</span><span class="p">))</span><span class="w">

    </span><span class="c1">## [1] 0</span><span class="w">

    </span><span class="n">glimpse</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Rows: 4,243,193</span><span class="w">
    </span><span class="c1">## Columns: 19</span><span class="w">
    </span><span class="c1">## $ ride_id            &lt;chr&gt; "F96D5A74A3E41399", "13CB7EB698CEDB88", "BD88A2E670…</span><span class="w">
    </span><span class="c1">## $ rideable_type      &lt;chr&gt; "electric_bike", "classic_bike", "electric_bike", "…</span><span class="w">
    </span><span class="c1">## $ started_at         &lt;dttm&gt; 2023-01-21 20:05:42, 2023-01-10 15:37:36, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ ended_at           &lt;dttm&gt; 2023-01-21 20:16:33, 2023-01-10 15:46:05, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ start_station_name &lt;chr&gt; "Lincoln Ave &amp; Fullerton Ave", "Kimbark Ave &amp; 53rd …</span><span class="w">
    </span><span class="c1">## $ start_station_id   &lt;chr&gt; "TA1309000058", "TA1309000037", "RP-005", "TA130900…</span><span class="w">
    </span><span class="c1">## $ end_station_name   &lt;chr&gt; "Hampden Ct &amp; Diversey Ave", "Greenwood Ave &amp; 47th …</span><span class="w">
    </span><span class="c1">## $ end_station_id     &lt;chr&gt; "202480.0", "TA1308000002", "599", "TA1308000002", …</span><span class="w">
    </span><span class="c1">## $ start_lat          &lt;dbl&gt; 41.92407, 41.79957, 42.00857, 41.79957, 41.79957, 4…</span><span class="w">
    </span><span class="c1">## $ start_lng          &lt;dbl&gt; -87.64628, -87.59475, -87.69048, -87.59475, -87.594…</span><span class="w">
    </span><span class="c1">## $ end_lat            &lt;dbl&gt; 41.93000, 41.80983, 42.03974, 41.80983, 41.80983, 4…</span><span class="w">
    </span><span class="c1">## $ end_lng            &lt;dbl&gt; -87.64000, -87.59938, -87.69941, -87.59938, -87.599…</span><span class="w">
    </span><span class="c1">## $ user_type          &lt;chr&gt; "member", "member", "casual", "member", "member", "…</span><span class="w">
    </span><span class="c1">## $ ride_length        &lt;dbl&gt; 10.850000, 8.483333, 13.233333, 8.766667, 15.316667…</span><span class="w">
    </span><span class="c1">## $ date               &lt;date&gt; 2023-01-21, 2023-01-10, 2023-01-02, 2023-01-22, 20…</span><span class="w">
    </span><span class="c1">## $ month              &lt;chr&gt; "01", "01", "01", "01", "01", "01", "01", "01", "01…</span><span class="w">
    </span><span class="c1">## $ day                &lt;chr&gt; "21", "10", "02", "22", "12", "31", "15", "25", "25…</span><span class="w">
    </span><span class="c1">## $ year               &lt;chr&gt; "2023", "2023", "2023", "2023", "2023", "2023", "20…</span><span class="w">
    </span><span class="c1">## $ day_of_week        &lt;chr&gt; "Saturday", "Tuesday", "Monday", "Sunday", "Thursda…</span><span class="w">

    </span><span class="n">summary</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="p">)</span><span class="w">

    </span><span class="c1">##    ride_id          rideable_type        started_at</span><span class="w">
    </span><span class="c1">##  Length:4243193     Length:4243193     Min.   :2023-01-01 00:02:06.00</span><span class="w">
    </span><span class="c1">##  Class :character   Class :character   1st Qu.:2023-05-20 18:06:14.00</span><span class="w">
    </span><span class="c1">##  Mode  :character   Mode  :character   Median :2023-07-20 18:29:02.00</span><span class="w">
    </span><span class="c1">##                                        Mean   :2023-07-16 01:55:18.68</span><span class="w">
    </span><span class="c1">##                                        3rd Qu.:2023-09-16 19:11:08.00</span><span class="w">
    </span><span class="c1">##                                        Max.   :2023-12-31 23:58:55.00</span><span class="w">
    </span><span class="c1">##     ended_at                     start_station_name start_station_id</span><span class="w">
    </span><span class="c1">##  Min.   :2023-01-01 00:07:23.0   Length:4243193     Length:4243193</span><span class="w">
    </span><span class="c1">##  1st Qu.:2023-05-20 18:28:00.0   Class :character   Class :character</span><span class="w">
    </span><span class="c1">##  Median :2023-07-20 18:46:38.0   Mode  :character   Mode  :character</span><span class="w">
    </span><span class="c1">##  Mean   :2023-07-16 02:11:31.9</span><span class="w">
    </span><span class="c1">##  3rd Qu.:2023-09-16 19:27:30.0</span><span class="w">
    </span><span class="c1">##  Max.   :2024-01-01 14:20:23.0</span><span class="w">
    </span><span class="c1">##  end_station_name   end_station_id       start_lat       start_lng</span><span class="w">
    </span><span class="c1">##  Length:4243193     Length:4243193     Min.   :41.65   Min.   :-87.84</span><span class="w">
    </span><span class="c1">##  Class :character   Class :character   1st Qu.:41.88   1st Qu.:-87.66</span><span class="w">
    </span><span class="c1">##  Mode  :character   Mode  :character   Median :41.90   Median :-87.64</span><span class="w">
    </span><span class="c1">##                                        Mean   :41.90   Mean   :-87.64</span><span class="w">
    </span><span class="c1">##                                        3rd Qu.:41.93   3rd Qu.:-87.63</span><span class="w">
    </span><span class="c1">##                                        Max.   :42.06   Max.   :-87.53</span><span class="w">
    </span><span class="c1">##     end_lat         end_lng        user_type          ride_length</span><span class="w">
    </span><span class="c1">##  Min.   : 0.00   Min.   :-87.84   Length:4243193     Min.   :   1.017</span><span class="w">
    </span><span class="c1">##  1st Qu.:41.88   1st Qu.:-87.66   Class :character   1st Qu.:   5.833</span><span class="w">
    </span><span class="c1">##  Median :41.90   Median :-87.64   Mode  :character   Median :  10.017</span><span class="w">
    </span><span class="c1">##  Mean   :41.90   Mean   :-87.64                      Mean   :  16.220</span><span class="w">
    </span><span class="c1">##  3rd Qu.:41.93   3rd Qu.:-87.63                      3rd Qu.:  17.733</span><span class="w">
    </span><span class="c1">##  Max.   :42.06   Max.   :  0.00                      Max.   :1439.867</span><span class="w">
    </span><span class="c1">##       date               month               day                year</span><span class="w">
    </span><span class="c1">##  Min.   :2023-01-01   Length:4243193     Length:4243193     Length:4243193</span><span class="w">
    </span><span class="c1">##  1st Qu.:2023-05-20   Class :character   Class :character   Class :character</span><span class="w">
    </span><span class="c1">##  Median :2023-07-20   Mode  :character   Mode  :character   Mode  :character</span><span class="w">
    </span><span class="c1">##  Mean   :2023-07-15</span><span class="w">
    </span><span class="c1">##  3rd Qu.:2023-09-16</span><span class="w">
    </span><span class="c1">##  Max.   :2023-12-31</span><span class="w">
    </span><span class="c1">##  day_of_week</span><span class="w">
    </span><span class="c1">##  Length:4243193</span><span class="w">
    </span><span class="c1">##  Class :character</span><span class="w">
    </span><span class="c1">##  Mode  :character</span><span class="w">
    </span><span class="c1">##</span><span class="w">
    </span><span class="c1">##</span><span class="w">
    </span><span class="c1">##</span><span class="w">
</span></code></pre></div></div> <h1 id="analysis">ANALYSIS</h1> <p><strong>How do annual members and casual riders differ in their use of Cyclistic’s bikes?</strong> Based on the quartiles, most ride duration fall below 50 minutes. By setting this limit, the focus remains on the most relevant portion of the dataset, avoiding the distortion caused by extreme outliers. This helps to clearly visualize the central distribution of the data without being skewed by a few extreme values.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">ride_length</span><span class="p">))</span><span class="w">

    </span><span class="c1">## [1] 0</span><span class="w">

    </span><span class="n">Q1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">quantile</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">ride_length</span><span class="p">,</span><span class="w"> </span><span class="m">0.25</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
    </span><span class="n">Q3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">quantile</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">ride_length</span><span class="p">,</span><span class="w"> </span><span class="m">0.75</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
    </span><span class="c1">#Q1.2 &lt;- quantile(annual_data_v2$ride_length, 0.25)</span><span class="w">
    </span><span class="c1">#Q3.2 &lt;- quantile(annual_data_v2$ride_length, 0.75)</span><span class="w">

    </span><span class="n">IQR_value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Q3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Q1</span><span class="w">

    </span><span class="c1">### Definir límites (1.5 veces el IQR)</span><span class="w">
    </span><span class="n">lower_bound</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Q1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">IQR_value</span><span class="w">
    </span><span class="n">upper_bound</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Q3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">IQR_value</span><span class="w">

    </span><span class="c1">### Filtrar los valores dentro de estos límites</span><span class="w">
    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
     </span><span class="n">filter</span><span class="p">(</span><span class="n">ride_length</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">lower_bound</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ride_length</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">upper_bound</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Crear el gráfico de violín con los datos filtrados</span><span class="w">
    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ride_length</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_violin</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">outlier.shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">theme_ipsum</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ride length distribution by user type "</span><span class="p">,</span><span class="w">
      </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="s2">"User type"</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="w"> </span><span class="s2">"Ride Length (min)"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User type"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/unnamed-chunk-17-1-480.webp 480w,/assets/img/unnamed-chunk-17-1-800.webp 800w,/assets/img/unnamed-chunk-17-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/unnamed-chunk-17-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Ride distribution" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Convert numeric month representation to month names</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">typeof</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">month</span><span class="p">)</span><span class="w">

    </span><span class="c1">## [1] "character"</span><span class="w">

    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">mutate</span><span class="p">(</span><span class="n">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recode</span><span class="p">(</span><span class="n">month</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"01"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"January"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"02"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"February"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"03"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"March"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"04"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"April"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"05"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"May"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"06"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"June"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"07"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"July"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"08"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"August"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"09"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"September"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"10"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"October"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"11"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"November"</span><span class="w">
                                  </span><span class="p">,</span><span class="s2">"12"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"December"</span><span class="p">))</span><span class="w">

    </span><span class="n">glimpse</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Rows: 3,920,772</span><span class="w">
    </span><span class="c1">## Columns: 19</span><span class="w">
    </span><span class="c1">## $ ride_id            &lt;chr&gt; "F96D5A74A3E41399", "13CB7EB698CEDB88", "BD88A2E670…</span><span class="w">
    </span><span class="c1">## $ rideable_type      &lt;chr&gt; "electric_bike", "classic_bike", "electric_bike", "…</span><span class="w">
    </span><span class="c1">## $ started_at         &lt;dttm&gt; 2023-01-21 20:05:42, 2023-01-10 15:37:36, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ ended_at           &lt;dttm&gt; 2023-01-21 20:16:33, 2023-01-10 15:46:05, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ start_station_name &lt;chr&gt; "Lincoln Ave &amp; Fullerton Ave", "Kimbark Ave &amp; 53rd …</span><span class="w">
    </span><span class="c1">## $ start_station_id   &lt;chr&gt; "TA1309000058", "TA1309000037", "RP-005", "TA130900…</span><span class="w">
    </span><span class="c1">## $ end_station_name   &lt;chr&gt; "Hampden Ct &amp; Diversey Ave", "Greenwood Ave &amp; 47th …</span><span class="w">
    </span><span class="c1">## $ end_station_id     &lt;chr&gt; "202480.0", "TA1308000002", "599", "TA1308000002", …</span><span class="w">
    </span><span class="c1">## $ start_lat          &lt;dbl&gt; 41.92407, 41.79957, 42.00857, 41.79957, 41.79957, 4…</span><span class="w">
    </span><span class="c1">## $ start_lng          &lt;dbl&gt; -87.64628, -87.59475, -87.69048, -87.59475, -87.594…</span><span class="w">
    </span><span class="c1">## $ end_lat            &lt;dbl&gt; 41.93000, 41.80983, 42.03974, 41.80983, 41.80983, 4…</span><span class="w">
    </span><span class="c1">## $ end_lng            &lt;dbl&gt; -87.64000, -87.59938, -87.69941, -87.59938, -87.599…</span><span class="w">
    </span><span class="c1">## $ user_type          &lt;chr&gt; "member", "member", "casual", "member", "member", "…</span><span class="w">
    </span><span class="c1">## $ ride_length        &lt;dbl&gt; 10.850000, 8.483333, 13.233333, 8.766667, 15.316667…</span><span class="w">
    </span><span class="c1">## $ date               &lt;date&gt; 2023-01-21, 2023-01-10, 2023-01-02, 2023-01-22, 20…</span><span class="w">
    </span><span class="c1">## $ month              &lt;chr&gt; "January", "January", "January", "January", "Januar…</span><span class="w">
    </span><span class="c1">## $ day                &lt;chr&gt; "21", "10", "02", "22", "12", "31", "15", "25", "25…</span><span class="w">
    </span><span class="c1">## $ year               &lt;chr&gt; "2023", "2023", "2023", "2023", "2023", "2023", "20…</span><span class="w">
    </span><span class="c1">## $ day_of_week        &lt;chr&gt; "Saturday", "Tuesday", "Monday", "Sunday", "Thursda…</span><span class="w">
</span></code></pre></div></div> <p>Rides made in the year 2023 will be displayed for each user type.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">user_type</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">mutate</span><span class="p">(</span><span class="n">fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">mutate</span><span class="p">(</span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cumsum</span><span class="p">(</span><span class="n">fraction</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">mutate</span><span class="p">(</span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">-1</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">mutate</span><span class="p">(</span><span class="n">label_position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ymax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ymin</span><span class="p">)</span><span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">mutate</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">user_type</span><span class="p">,</span><span class="s2">"\n"</span><span class="p">,</span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="c1">#plot</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">ymax</span><span class="o">=</span><span class="n">ymax</span><span class="p">,</span><span class="w"> </span><span class="n">ymin</span><span class="o">=</span><span class="n">ymin</span><span class="p">,</span><span class="w"> </span><span class="n">xmax</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">xmin</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">user_type</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_rect</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"casual"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"member"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"casual"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"member"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Amount of users"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">5.5</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">label_position</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">user_type</span><span class="p">),</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">coord_polar</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="s2">"y"</span><span class="p">,</span><span class="w"> </span><span class="n">clip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"off"</span><span class="p">)</span><span class="o">+</span><span class="n">xlim</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_void</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/unnamed-chunk-19-1-480.webp 480w,/assets/img/unnamed-chunk-19-1-800.webp 800w,/assets/img/unnamed-chunk-19-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/unnamed-chunk-19-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Amount of users" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Descriptive analysis of the <code class="language-plaintext highlighter-rouge">ride_length</code> variable will provide insights and the distribution of ride duration across different user types.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">summary</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">ride_length</span><span class="p">)</span><span class="w">

    </span><span class="c1">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.</span><span class="w">
    </span><span class="c1">##   1.017   5.567   9.267  11.373  15.267  35.583</span><span class="w">

    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">user_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"member"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Filtrar solo los usuarios tipo "casual"</span><span class="w">
      </span><span class="n">pull</span><span class="p">(</span><span class="n">ride_length</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Extraer la columna ride_length</span><span class="w">
      </span><span class="n">summary</span><span class="p">()</span><span class="w">

    </span><span class="c1">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.</span><span class="w">
    </span><span class="c1">##   1.017   5.133   8.500  10.546  13.967  35.583</span><span class="w">

    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">user_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"casual"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Filtrar solo los usuarios tipo "casual"</span><span class="w">
      </span><span class="n">pull</span><span class="p">(</span><span class="n">ride_length</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span><span class="c1"># Extraer la columna ride_length</span><span class="w">
      </span><span class="n">summary</span><span class="p">()</span><span class="w">

    </span><span class="c1">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.</span><span class="w">
    </span><span class="c1">##   1.017   6.733  11.050  13.080  17.917  35.583</span><span class="w">
</span></code></pre></div></div> <p>Compare the two user types</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">aggregate</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">ride_length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">

    </span><span class="c1">##   annual_data_v2$user_type annual_data_v2$ride_length</span><span class="w">
    </span><span class="c1">## 1                   casual                   13.08008</span><span class="w">
    </span><span class="c1">## 2                   member                   10.54565</span><span class="w">

    </span><span class="n">aggregate</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">ride_length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">)</span><span class="w">

    </span><span class="c1">##   annual_data_v2$user_type annual_data_v2$ride_length</span><span class="w">
    </span><span class="c1">## 1                   casual                      11.05</span><span class="w">
    </span><span class="c1">## 2                   member                       8.50</span><span class="w">

    </span><span class="n">aggregate</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">ride_length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">)</span><span class="w">

    </span><span class="c1">##   annual_data_v2$user_type annual_data_v2$ride_length</span><span class="w">
    </span><span class="c1">## 1                   casual                   35.58333</span><span class="w">
    </span><span class="c1">## 2                   member                   35.58333</span><span class="w">

    </span><span class="n">aggregate</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">ride_length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">,</span><span class="w"> </span><span class="p">)</span><span class="w">

    </span><span class="c1">##   annual_data_v2$user_type annual_data_v2$ride_length</span><span class="w">
    </span><span class="c1">## 1                   casual                   1.016667</span><span class="w">
    </span><span class="c1">## 2                   member                   1.016667</span><span class="w">
</span></code></pre></div></div> <p>Convert to ordered factor the column and save the file for further analysis.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">day_of_week</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ordered</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">day_of_week</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"Monday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Tuesday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Wednesday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Thursday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Friday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Saturday"</span><span class="p">,</span><span class="s2">"Sunday"</span><span class="p">))</span><span class="w">
    </span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ordered</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="o">$</span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"January"</span><span class="p">,</span><span class="w"> </span><span class="s2">"February"</span><span class="p">,</span><span class="w"> </span><span class="s2">"March"</span><span class="p">,</span><span class="w"> </span><span class="s2">"April"</span><span class="p">,</span><span class="w"> </span><span class="s2">"May"</span><span class="p">,</span><span class="w"> </span><span class="s2">"June"</span><span class="p">,</span><span class="w"> </span><span class="s2">"July"</span><span class="p">,</span><span class="w"> </span><span class="s2">"August"</span><span class="p">,</span><span class="w"> </span><span class="s2">"September"</span><span class="p">,</span><span class="w"> </span><span class="s2">"October"</span><span class="p">,</span><span class="w"> </span><span class="s2">"November"</span><span class="p">,</span><span class="w"> </span><span class="s2">"December"</span><span class="p">))</span><span class="w">

    </span><span class="n">write_csv</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="p">,</span><span class="w"> </span><span class="s2">"D:/Proyecto_R/annual_data_v2.csv"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>It can be observed that the duration of rides is longer for casual users during weekends.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">glimpse</span><span class="p">(</span><span class="n">annual_data_v2</span><span class="p">)</span><span class="w">

    </span><span class="c1">## Rows: 3,920,772</span><span class="w">
    </span><span class="c1">## Columns: 19</span><span class="w">
    </span><span class="c1">## $ ride_id            &lt;chr&gt; "F96D5A74A3E41399", "13CB7EB698CEDB88", "BD88A2E670…</span><span class="w">
    </span><span class="c1">## $ rideable_type      &lt;chr&gt; "electric_bike", "classic_bike", "electric_bike", "…</span><span class="w">
    </span><span class="c1">## $ started_at         &lt;dttm&gt; 2023-01-21 20:05:42, 2023-01-10 15:37:36, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ ended_at           &lt;dttm&gt; 2023-01-21 20:16:33, 2023-01-10 15:46:05, 2023-01-…</span><span class="w">
    </span><span class="c1">## $ start_station_name &lt;chr&gt; "Lincoln Ave &amp; Fullerton Ave", "Kimbark Ave &amp; 53rd …</span><span class="w">
    </span><span class="c1">## $ start_station_id   &lt;chr&gt; "TA1309000058", "TA1309000037", "RP-005", "TA130900…</span><span class="w">
    </span><span class="c1">## $ end_station_name   &lt;chr&gt; "Hampden Ct &amp; Diversey Ave", "Greenwood Ave &amp; 47th …</span><span class="w">
    </span><span class="c1">## $ end_station_id     &lt;chr&gt; "202480.0", "TA1308000002", "599", "TA1308000002", …</span><span class="w">
    </span><span class="c1">## $ start_lat          &lt;dbl&gt; 41.92407, 41.79957, 42.00857, 41.79957, 41.79957, 4…</span><span class="w">
    </span><span class="c1">## $ start_lng          &lt;dbl&gt; -87.64628, -87.59475, -87.69048, -87.59475, -87.594…</span><span class="w">
    </span><span class="c1">## $ end_lat            &lt;dbl&gt; 41.93000, 41.80983, 42.03974, 41.80983, 41.80983, 4…</span><span class="w">
    </span><span class="c1">## $ end_lng            &lt;dbl&gt; -87.64000, -87.59938, -87.69941, -87.59938, -87.599…</span><span class="w">
    </span><span class="c1">## $ user_type          &lt;chr&gt; "member", "member", "casual", "member", "member", "…</span><span class="w">
    </span><span class="c1">## $ ride_length        &lt;dbl&gt; 10.850000, 8.483333, 13.233333, 8.766667, 15.316667…</span><span class="w">
    </span><span class="c1">## $ date               &lt;date&gt; 2023-01-21, 2023-01-10, 2023-01-02, 2023-01-22, 20…</span><span class="w">
    </span><span class="c1">## $ month              &lt;ord&gt; January, January, January, January, January, Januar…</span><span class="w">
    </span><span class="c1">## $ day                &lt;chr&gt; "21", "10", "02", "22", "12", "31", "15", "25", "25…</span><span class="w">
    </span><span class="c1">## $ year               &lt;chr&gt; "2023", "2023", "2023", "2023", "2023", "2023", "20…</span><span class="w">
    </span><span class="c1">## $ day_of_week        &lt;ord&gt; Saturday, Tuesday, Monday, Sunday, Thursday, Tuesda…</span><span class="w">
</span></code></pre></div></div> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">aggregate</span><span class="p">(</span><span class="n">ride_length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">user_type</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">day_of_week</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">day_of_week</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ride_length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_line</span><span class="p">(</span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average Ride Duration by User Type and Day of the Week"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Day of Week"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average Ride Length (min)"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User Type"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"casual"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"member"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Week-1-480.webp 480w,/assets/img/Week-1-800.webp 800w,/assets/img/Week-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Week-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Week-1" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This chart allows for easy visualization of how the average ride duration varies between casual users and members throughout the months of the year.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">aggregate</span><span class="p">(</span><span class="n">ride_length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">user_type</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ride_length</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_line</span><span class="p">(</span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average Ride Duration by User Type and Month"</span><span class="w">
      </span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Month"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average Ride Length (min)"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User Type"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"casual"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"member"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">45</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Month-1-480.webp 480w,/assets/img/Month-1-800.webp 800w,/assets/img/Month-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Month-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Analyze users data by user type, weekday, weekends and holidays The number of rides on federal holidays is calculated using the <code class="language-plaintext highlighter-rouge">cal_us_federal()</code> function, which serves as an example calendar representing the federal holidays in the United States. This calendar is not historically accurate but reflects the currently recognized federal holidays.”</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">holidays_2023</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cal_events</span><span class="p">(</span><span class="n">cal_us_federal</span><span class="p">(),</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2023</span><span class="p">)</span><span class="w">
    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">user_type</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">inner_join</span><span class="p">(</span><span class="n">holidays_2023</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="s2">"date"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number_of_rides</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"casual"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"member"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_col</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dodge"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">)),</span><span class="w">
                </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">position_dodge</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w">
                </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.5</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Rides on holidays"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User type"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s2">"Number of rides"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User type"</span><span class="p">)</span><span class="w">  </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/holidays-1-480.webp 480w,/assets/img/holidays-1-800.webp 800w,/assets/img/holidays-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/holidays-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="holidays" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">day_of_week</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Saturday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Sunday"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">user_type</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number_of_rides</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"casual"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"member"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_col</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dodge"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">)),</span><span class="w">
                </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">position_dodge</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w">
                </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.5</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Rides on weekends"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User type"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s2">"Number of rides"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User type"</span><span class="p">)</span><span class="w">  </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Rides%20on%20weekends-1-480.webp 480w,/assets/img/Rides%20on%20weekends-1-800.webp 800w,/assets/img/Rides%20on%20weekends-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Rides%20on%20weekends-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Rides on weekends" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">day_of_week</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Monday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Tuesday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Wednesday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Thursday"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Friday"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">user_type</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number_of_rides</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"casual"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"member"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_col</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dodge"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">)),</span><span class="w">
                </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">position_dodge</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w">
                </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.5</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Rides on weekdays"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User type"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s2">"Number of rides"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User type"</span><span class="p">)</span><span class="w">  </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Rides%20on%20weekdays-1-480.webp 480w,/assets/img/Rides%20on%20weekdays-1-800.webp 800w,/assets/img/Rides%20on%20weekdays-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Rides%20on%20weekdays-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Rides on weekdays" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This creates a seasons data frame with columns representing the start and end months for each season, the name of each season, and a custom color for each. These values will be used later to mark the different seasons on the plot.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="c1">#data frame for later use in the plot</span><span class="w">
    </span><span class="n">seasons</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="w">
      </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w">  </span><span class="c1"># Srart month for each season</span><span class="w">
      </span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">),</span><span class="w">    </span><span class="c1"># End month for each season</span><span class="w">
      </span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Winter"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Spring"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Summer"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Autumn"</span><span class="p">),</span><span class="w">
      </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"#0071bc"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#2e8540"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#981b1e"</span><span class="p">,</span><span class="w"> </span><span class="s2">"#aeb0b5"</span><span class="p">)</span><span class="w">  </span><span class="c1">#color for each season</span><span class="w">
    </span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <p>These two blocks of code find the months with the maximum and minimum number of rides for each user_type. The max_points and min_points data frames store these extreme values, which will later be used to add text annotations to the plot.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="c1"># Find the maximum points</span><span class="w">
    </span><span class="n">max_points</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">))</span><span class="w">
    </span><span class="c1"># Find the minimum points</span><span class="w">
    </span><span class="n">min_points</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <p>This code creates a comprehensive plot, comparing the monthly number of rides for casual and member users, with annotations for seasonal changes and the maximum and minimum values.</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">mutate</span><span class="p">(</span><span class="n">weekday</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wday</span><span class="p">(</span><span class="n">started_at</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">week_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LC_TIME"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">arrange</span><span class="p">(</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="c1">#plot</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number_of_rides</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_rect</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seasons</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">xmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">xmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">),</span><span class="w"> </span><span class="n">inherit.aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_line</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max_points</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"max:"</span><span class="p">,</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">))),</span><span class="w"> </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-.28</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-.2</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#08415c"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># Añadir etiquetas en los puntos máximos</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min_points</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"min:"</span><span class="p">,</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">))),</span><span class="w"> </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#08415c"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># Añadir etiquetas en los puntos máximos</span><span class="w">
      </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seasons</span><span class="o">$</span><span class="n">color</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="c1"># Usar colores definidos</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Monthly Evolution of the Number of Rides by User Type and Season"</span><span class="p">,</span><span class="w">
           </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Month"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of Rides"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User Type"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Season"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"casual"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"member"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">45</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Number%20of%20Rides%20by%20Transport%20Type%20and%20User%20Type-1-480.webp 480w,/assets/img/Number%20of%20Rides%20by%20Transport%20Type%20and%20User%20Type-1-800.webp 800w,/assets/img/Number%20of%20Rides%20by%20Transport%20Type%20and%20User%20Type-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Number%20of%20Rides%20by%20Transport%20Type%20and%20User%20Type-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Number of Rides by Transport Type and User Type-1" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">rideable_type</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">(),</span><span class="w"> </span><span class="n">.groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'drop'</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">complete</span><span class="p">(</span><span class="n">user_type</span><span class="p">,</span><span class="w"> </span><span class="n">rideable_type</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="c1">#plot</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rideable_type</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number_of_rides</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_type</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"casual"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"member"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_col</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dodge"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">)),</span><span class="w">
                </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">position_dodge</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w">
                </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of Rides by Transport Type and User Type"</span><span class="p">,</span><span class="w">
           </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Tipo de Transporte"</span><span class="p">,</span><span class="w">
           </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Transport Type"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"User type"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_x_discrete</span><span class="p">(</span><span class="w">  </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"Classic bike"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Docked bike"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Electric bike"</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#F5F5F5"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;div class="col-sm mt-3 mt-md-0"&gt;
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Number%20of%20Rides%20by%20Transport%20Type%20and%20User%20Type-1-480.webp 480w,/assets/img/Number%20of%20Rides%20by%20Transport%20Type%20and%20User%20Type-1-800.webp 800w,/assets/img/Number%20of%20Rides%20by%20Transport%20Type%20and%20User%20Type-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Number%20of%20Rides%20by%20Transport%20Type%20and%20User%20Type-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Number of Rides by Transport Type and User Type" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/div&gt;
</code></pre></div></div> <p>&lt;/div&gt;</p> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">user_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"casual"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">start_station_name</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">slice_max</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="n">number_of_rides</span><span class="p">,</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">reorder</span><span class="p">(</span><span class="n">start_station_name</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_rides</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">number_of_rides</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Top 10 Start Stations for Casual Users by Number of Rides"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s2">"Station name"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of rides"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">)),</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="o">=</span><span class="m">.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">coord_flip</span><span class="p">()</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Top%2010%20start%20stations%20for%20Casual%20Users%20by%20Number%20of%20Rides-1-480.webp 480w,/assets/img/Top%2010%20start%20stations%20for%20Casual%20Users%20by%20Number%20of%20Rides-1-800.webp 800w,/assets/img/Top%2010%20start%20stations%20for%20Casual%20Users%20by%20Number%20of%20Rides-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Top%2010%20start%20stations%20for%20Casual%20Users%20by%20Number%20of%20Rides-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Top 10 start stations for Casual Users by Number of Rides" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">user_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"casual"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">end_station_name</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">slice_max</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="n">number_of_rides</span><span class="p">,</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">reorder</span><span class="p">(</span><span class="n">end_station_name</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_rides</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">number_of_rides</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Top 10 end stations for Casual Users by Number of Rides"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s2">"Station name"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of rides"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#4DB6AC"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">)),</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="o">=</span><span class="m">.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">coord_flip</span><span class="p">()</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Top%2010%20end%20stations%20for%20Casual%20Users%20by%20Number%20of%20Rides-1-480.webp 480w,/assets/img/Top%2010%20end%20stations%20for%20Casual%20Users%20by%20Number%20of%20Rides-1-800.webp 800w,/assets/img/Top%2010%20end%20stations%20for%20Casual%20Users%20by%20Number%20of%20Rides-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Top%2010%20end%20stations%20for%20Casual%20Users%20by%20Number%20of%20Rides-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Top 10 end stations for Casual Users by Number of Rides" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">user_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"member"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">start_station_name</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">slice_max</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="n">number_of_rides</span><span class="p">,</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">reorder</span><span class="p">(</span><span class="n">start_station_name</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_rides</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">number_of_rides</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Top 10 Start Stations for Member Users by Number of Rides"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s2">"Station name"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of rides"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">)),</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="o">=</span><span class="m">.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">coord_flip</span><span class="p">()</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Top%2010%20Start%20Stations%20for%20Member%20Users%20by%20Number%20of%20Rides-1-480.webp 480w,/assets/img/Top%2010%20Start%20Stations%20for%20Member%20Users%20by%20Number%20of%20Rides-1-800.webp 800w,/assets/img/Top%2010%20Start%20Stations%20for%20Member%20Users%20by%20Number%20of%20Rides-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Top%2010%20Start%20Stations%20for%20Member%20Users%20by%20Number%20of%20Rides-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Top 10 Start Stations for Member Users by Number of Rides" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">annual_data_v2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">filter</span><span class="p">(</span><span class="n">user_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"member"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">end_station_name</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarise</span><span class="p">(</span><span class="n">number_of_rides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">slice_max</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="n">number_of_rides</span><span class="p">,</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">reorder</span><span class="p">(</span><span class="n">end_station_name</span><span class="p">,</span><span class="w"> </span><span class="n">number_of_rides</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">number_of_rides</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Top 10 end stations for Member Users by Number of Rides"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s2">"Station name"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of rides"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FFAB40"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">(</span><span class="n">number_of_rides</span><span class="p">)),</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="o">=</span><span class="m">.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
      </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">coord_flip</span><span class="p">()</span><span class="w">
</span></code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Top%2010%20end%20stations%20for%20Member%20Users%20by%20Number%20of%20Rides-1-480.webp 480w,/assets/img/Top%2010%20end%20stations%20for%20Member%20Users%20by%20Number%20of%20Rides-1-800.webp 800w,/assets/img/Top%2010%20end%20stations%20for%20Member%20Users%20by%20Number%20of%20Rides-1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Top%2010%20end%20stations%20for%20Member%20Users%20by%20Number%20of%20Rides-1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Top 10 end stations for Member Users by Number of Rides-1" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><strong>Thank you so much for taking the time to check out my project!</strong></p> <h1 id="references">References</h1> <ul> <li> <p>Piasa, N. (2023, August 12). <a href="https://medium.com/@nattayapiasa/google-data-analytics-capstone-cyclistic-bike-share-python-5bd42c98f5ad" rel="external nofollow noopener" target="_blank">Google Data Analytics Capstone: Cyclistic Bike-Share (Python)</a>. <em>Medium</em>.</p> </li> <li> <p>Data con Steven. (2024, January 3). <a href="https://www.youtube.com/watch?v=Jgv7EwEECFg" rel="external nofollow noopener" target="_blank">Google Data Analytics | Proyecto Final | Caso Bellabeat [Video]. YouTube.</a></p> </li> <li> <p><a href="https://www.statology.org" rel="external nofollow noopener" target="_blank">https://www.statology.org</a></p> </li> <li> <p><a href="https://datavizcatalogue.com/" class="uri" rel="external nofollow noopener" target="_blank">https://datavizcatalogue.com</a></p> </li> </ul> <h2 id="tiktok-profiles-with-nice-data-content">TikTok profiles with nice data content</h2> <ul> <li> <p>@<a href="https://www.tiktok.com/@quimicaendata" rel="external nofollow noopener" target="_blank">quimicaendata</a></p> </li> <li> <p>@<a href="https://www.tiktok.com/@armandodatos" rel="external nofollow noopener" target="_blank">armandodatos</a></p> </li> <li> <p>@<a href="https://www.tiktok.com/@mai_analytics" rel="external nofollow noopener" target="_blank">mai_analytics</a></p> </li> <li> <p>@<a href="https://www.tiktok.com/@mkfnx" rel="external nofollow noopener" target="_blank">mkfnx</a></p> </li> </ul> </article> <h2>References</h2> <div class="publications"> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Daniel Herrera. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>